(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{22:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),o=n(11),r=(n(20),n(21),n(22),n(9)),s=n(4),i=n.n(s),l=n(5),u=n(8),d=n(2),j=n(3),b=n.n(j),f="https://mate.academy/students-api";function m(e){return new Promise((function(t){setTimeout(t,e)}))}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c={method:t};return n&&(c.body=JSON.stringify(n),c.headers={"Content-Type":"application/json; charset=UTF-8"}),m(300).then((function(){return fetch(f+e,c)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var O,h=function(e){return p(e)},v=function(e,t){return p(e,"POST",t)},x=function(e,t){return p(e,"PATCH",t)},y=function(e){return p(e,"DELETE")},g=function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,c=t.name,e.abrupt("return",v("/users",{email:n,name:c}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=n(0),k=function(e){var t=e.onLogin,n=Object(c.useState)(""),a=Object(d.a)(n,2),o=a[0],r=a[1],s=Object(c.useState)(""),u=Object(d.a)(s,2),j=u[0],f=u[1],m=Object(c.useState)(!1),p=Object(d.a)(m,2),O=p[0],h=p[1],v=Object(c.useState)(!1),x=Object(d.a)(v,2),y=x[0],k=x[1],_=Object(c.useState)(""),S=Object(d.a)(_,2),E=S[0],C=S[1],w=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(c.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(c){}}),[]);var F=function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(o);case 2:(t=e.sent)?w(t):h(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),C(""),k(!0),e.prev=3,!O){e.next=9;break}return e.next=7,N({name:j,email:o}).then(w);case 7:e.next=11;break;case 9:return e.next=11,F();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),C("Something went wrtong");case 16:return e.prev=16,k(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(T.jsxs)("form",{onSubmit:D,className:"box mt-5",children:[Object(T.jsx)("h1",{className:"title is-3",children:O?"You need to register":"Log in to open todos"}),Object(T.jsxs)("div",{className:"field",children:[Object(T.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(T.jsxs)("div",{className:b()("control has-icons-left",{"is-loading":y}),children:[Object(T.jsx)("input",{type:"email",id:"user-email",className:b()("input",{"is-danger":!O&&E}),placeholder:"Enter your email",disabled:y||O,value:o,required:!0,onChange:function(e){return r(e.target.value)}}),Object(T.jsx)("span",{className:"icon is-small is-left",children:Object(T.jsx)("i",{className:"fas fa-envelope"})})]}),!O&&E&&Object(T.jsx)("p",{className:"help is-danger",children:E})]}),O&&Object(T.jsxs)("div",{className:"field",children:[Object(T.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(T.jsxs)("div",{className:b()("control has-icons-left",{"is-loading":y}),children:[Object(T.jsx)("input",{type:"text",id:"user-name",className:b()("input",{"is-danger":O&&E}),placeholder:"Enter your name",required:!0,minLength:4,disabled:y,value:j,onChange:function(e){return f(e.target.value)}}),Object(T.jsx)("span",{className:"icon is-small is-left",children:Object(T.jsx)("i",{className:"fas fa-user"})})]}),O&&E&&Object(T.jsx)("p",{className:"help is-danger",children:E})]}),Object(T.jsx)("div",{className:"field",children:Object(T.jsx)("button",{type:"submit",className:b()("button is-primary",{"is-loading":y}),children:O?"Register":"Login"})})]})},_=a.a.createContext(null),S=function(e){var t=e.children,n=Object(c.useState)(null),a=Object(d.a)(n,2),o=a[0],r=a[1];return o?Object(T.jsx)(_.Provider,{value:o,children:t}):Object(T.jsx)(k,{onLogin:r})},E=function(e){var t=e.errorMsgTodo,n=e.hasLoadingTodoError,c=e.hasDeleteTodoError,a=e.hasUpdateTodoError,o=e.hideErrors,r=e.toHideErrors;return Object(T.jsxs)("div",{"data-cy":"ErrorNotification",className:b()("notification","is-danger","is-light","has-text-weight-normal",{hidden:o}),children:[Object(T.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete",onClick:r}),t&&Object(T.jsx)(T.Fragment,{children:"Title can't be empty"}),n&&Object(T.jsx)(T.Fragment,{children:"Unable to add a todo"}),Object(T.jsx)("br",{}),c&&Object(T.jsx)(T.Fragment,{children:"Unable to delete a todo"}),Object(T.jsx)("br",{}),a&&Object(T.jsx)(T.Fragment,{children:"Unable to update a todo"})]})};!function(e){e[e.all=0]="all",e[e.completed=1]="completed",e[e.active=2]="active"}(O||(O={}));var C=function(e){var t=e.countOfActiveTodo,n=e.countOfDoneTodo,c=e.removeAllDoneTodo,a=e.sortType,o=e.sortingTodos;return Object(T.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(T.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(t," items left")}),Object(T.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(T.jsx)("a",{"data-cy":"FilterLinkAll",href:"#/",className:b()("filter__link",{selected:a===O.all}),onClick:function(){return o(O.all)},children:"All"}),Object(T.jsx)("a",{"data-cy":"FilterLinkActive",href:"#/active",className:b()("filter__link",{selected:a===O.active}),onClick:function(){return o(O.active)},children:"Active"}),Object(T.jsx)("a",{"data-cy":"FilterLinkCompleted",href:"#/completed",className:b()("filter__link",{selected:a===O.completed}),onClick:function(){return o(O.completed)},children:"Completed"})]}),Object(T.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:b()("todoapp__clear-completed",{"is-invisible":0===n}),onClick:c,children:"Clear completed"})]})},w=function(e){var t=e.text;return Object(T.jsxs)("div",{"data-cy":"Todo",className:"todo",children:[Object(T.jsx)("label",{className:"todo__status-label",children:Object(T.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status"})}),Object(T.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",children:t}),Object(T.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",children:"\xd7"}),Object(T.jsxs)("div",{"data-cy":"TodoLoader",className:"modal overlay is-active",children:[Object(T.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(T.jsx)("div",{className:"loader"})]})]})},F=a.a.memo((function(e){var t=e.todo,n=e.removeOneTodo,a=e.hasUpdateError,o=e.isRemoving,r=e.isRemovingAll,s=e.updateStateTodos,i=Object(c.useState)(!1),l=Object(d.a)(i,2),u=l[0],j=l[1],f=Object(c.useState)(0),m=Object(d.a)(f,2),p=m[0],O=m[1],h=Object(c.useState)(!1),v=Object(d.a)(h,2),y=v[0],g=v[1],N=Object(c.useState)(t.title),k=Object(d.a)(N,2),_=k[0],S=k[1],E=function(e){j(!0),x("/todos/".concat(e.id),{title:_}).catch((function(){return a(!0)})).finally((function(){j(!1)}))},C=Object(c.useRef)(null);return Object(c.useEffect)((function(){C.current&&C.current.focus()}),[y]),Object(T.jsxs)("div",{"data-cy":"Todo",className:b()("todo",{completed:t.completed}),children:[Object(T.jsx)("label",{className:"todo__status-label",children:Object(T.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",defaultChecked:t.completed,onClick:function(){return e=t,j(!0),void x("/todos/".concat(e.id),{completed:!e.completed}).then((function(e){return s(e)})).catch((function(){return a(!0)})).finally((function(){return j(!1)}));var e}})}),y?Object(T.jsx)("form",{onSubmit:function(e){return e.preventDefault()},children:Object(T.jsx)("input",{"data-cy":"TodoTitleField",type:"text",className:"todo__title-field",value:_,ref:C,onChange:function(e){S(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&""!==_&&_!==t.title?(E(t),g(!1)):("Enter"===e.key&&""!==_||"Escape"===e.key)&&g(!1)},onBlur:function(){""!==_&&_!==t.title&&E(t),g(!1)}})}):Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){g(!0)},children:_}),Object(T.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",onClick:function(){n(t.id),O(t.id)},children:"\xd7"})]}),(u||o&&p===t.id||r&&t.completed)&&Object(T.jsxs)("div",{"data-cy":"TodoLoader",className:"modal overlay is-active",children:[Object(T.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(T.jsx)("div",{className:"loader"})]})]})})),D=function(){var e=Object(c.useContext)(_),t=Object(c.useRef)(null),n=Object(c.useState)([]),a=Object(d.a)(n,2),o=a[0],s=a[1],j=Object(c.useState)(""),f=Object(d.a)(j,2),m=f[0],p=f[1],g=Object(c.useState)(!1),N=Object(d.a)(g,2),k=N[0],S=N[1],D=Object(c.useState)(!1),L=Object(d.a)(D,2),A=L[0],I=L[1],U=Object(c.useState)(O.all),R=Object(d.a)(U,2),B=R[0],J=R[1],P=Object(c.useState)(!0),H=Object(d.a)(P,2),q=H[0],K=H[1],M=Object(c.useState)(!1),Y=Object(d.a)(M,2),G=Y[0],W=Y[1],z=Object(c.useState)(!1),Q=Object(d.a)(z,2),V=Q[0],X=Q[1],Z=Object(c.useState)(!1),$=Object(d.a)(Z,2),ee=$[0],te=$[1],ne=Object(c.useState)(!1),ce=Object(d.a)(ne,2),ae=ce[0],oe=ce[1],re=Object(c.useState)(!1),se=Object(d.a)(re,2),ie=se[0],le=se[1],ue=Object(c.useCallback)((function(){setTimeout((function(){return K(!0)}),3e3)}),[]);Object(c.useEffect)((function(){var n;t.current&&t.current.focus(),e&&(n=e.id,h("/todos?userId=".concat(n))).then((function(e){return s(e.map((function(e){return{id:e.id,userId:e.userId,title:e.title,completed:e.completed}})))})).catch((function(){return W(!0)}))}),[]);var de=Object(u.a)(o);switch(B){case O.completed:de=o.filter((function(e){return!0===e.completed}));break;case O.active:de=o.filter((function(e){return!1===e.completed}));break;case O.all:}var je=Object(c.useCallback)((function(e){J(e)}),[]),be=o.every((function(e){return!0===e.completed})),fe=0,me=0;o.forEach((function(e){e.completed?me+=1:fe+=1}));var pe=null!==e&&""!==m.trim()&&!k,Oe=function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(o.map((function(e){return x("/todos/".concat(e.id),{completed:!be})})));case 2:t=e.sent,s(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=Object(c.useCallback)((function(e){oe(!0),y("/todos/".concat(e)).catch((function(){te(!0),K(!1)})).finally((function(){oe(!1),ee||s((function(t){return t.filter((function(t){return t.id!==e}))}))}))}),[]),ve=Object(c.useCallback)((function(e){return X(e)}),[]),xe=function(e){s((function(t){return t.map((function(t){return t.id===e.id&&(t=Object(r.a)(Object(r.a)({},t),{},{completed:e.completed})),t}))}))};return Object(T.jsxs)("div",{className:"todoapp",children:[Object(T.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(T.jsxs)("div",{className:"todoapp__content",children:[Object(T.jsxs)("header",{className:"todoapp__header",children:[Object(T.jsx)("button",{"data-cy":"ToggleAllButton",type:"button",className:b()("todoapp__toggle-all",{active:be}),onClick:Oe}),Object(T.jsx)("form",{onSubmit:function(e){return e.preventDefault()},children:Object(T.jsx)("input",{"data-cy":"NewTodoField",type:"text",ref:t,className:"todoapp__new-todo bulma-loader-mixin",placeholder:"What needs to be done?",value:m,onChange:function(e){p(e.target.value),K(!0)},onKeyUp:function(t){"Enter"===t.key&&e&&""===m.trim()?(I(!0),K(!1),ue()):"Enter"===t.key&&pe&&null!==e&&(S(!0),v("/todos",{title:m,userId:e.id,completed:!1}).then((function(e){var t={id:e.id,userId:e.userId,title:e.title,completed:e.completed};s((function(e){return[].concat(Object(u.a)(e),[t])}))})).catch((function(){W(!0),K(!1),ue()})).finally((function(){p(""),S(!1)})))}})})]}),Object(T.jsxs)("section",{className:"todoapp__main","data-cy":"TodoList",children:[de.map((function(e){return Object(T.jsx)(F,{todo:e,removeOneTodo:he,hasUpdateError:ve,isRemoving:ae,isRemovingAll:ie,updateStateTodos:xe},e.id)})),k&&Object(T.jsx)(w,{text:m})]}),o.length>0&&Object(T.jsx)(C,{countOfActiveTodo:fe,countOfDoneTodo:me,removeAllDoneTodo:function(){o.forEach((function(e){e.completed&&(le(!0),y("/todos/".concat(e.id)).catch((function(){return te(!0)})).finally((function(){le(!1),ee||s((function(t){return t.filter((function(t){return t.id!==e.id}))}))})))}))},sortType:B,sortingTodos:je})]}),Object(T.jsx)(E,{errorMsgTodo:A,hasLoadingTodoError:G,hasDeleteTodoError:ee,hasUpdateTodoError:V,hideErrors:q,toHideErrors:function(){K(!0)}})]})},L=function(){return Object(T.jsx)(S,{children:Object(T.jsx)(D,{})})};Object(o.createRoot)(document.getElementById("root")).render(Object(T.jsx)(L,{}))}},[[25,1,2]]]);
//# sourceMappingURL=main.f47f9f1b.chunk.js.map